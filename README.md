<!DOCTYPE html>
<html lang="th">
<head>
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<meta charset="UTF-8">
<title>‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏ö‡∏ï‡∏™‡∏≥‡∏£‡∏≠‡∏á</title>

<style>
body{
    font-family: Arial;
    background:#f2f2f2;
    padding:20px;
}

h2{text-align:center;}

.container{
    display:flex;
    gap:20px;
    flex-wrap:wrap;
}

form{
    background:white;
    padding:15px;
    width:300px;
    border-radius:8px;
}

input,select,button{
    width:100%;
    padding:8px;
    margin:5px 0;
}

button{
    background:#007bff;
    color:white;
    border:none;
    cursor:pointer;
    font-weight:bold;
}

.backup-btn{ background:#28a745; }
.restore-btn{ background:#f39c12; }

.grid{
    display:grid;
    grid-template-columns: repeat(4, 1fr);
    gap:10px;
    width:500px;
}

.cell{
    padding:15px;
    text-align:center;
    font-weight:bold;
    border-radius:6px;
    cursor:pointer;
}

.free{ background:#7CFC90; }
.used{ background:#FF6B6B; color:white; }

.info{ font-size:12px; }

.history{
    margin-top:30px;
    background:white;
    padding:15px;
    border-radius:8px;
}

table{
    width:100%;
    border-collapse:collapse;
}

th,td{
    border:1px solid #ccc;
    padding:6px;
    text-align:center;
    font-size:12px;
}

th{
    background:#007bff;
    color:white;
}
</style>
</head>

<body>

<h2>‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÅ‡∏ö‡∏ï‡∏™‡∏≥‡∏£‡∏≠‡∏á</h2>

<div class="container">

<form id="form">

<h3>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h3>

<input type="text" id="empID" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô" required>
<input type="text" id="empName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô" readonly>

<!-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å RF -->
<select id="rf" required></select>

<button type="submit">‡πÄ‡∏ö‡∏¥‡∏Å‡πÅ‡∏ö‡∏ï</button>
<button type="button" onclick="returnBattery()">‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏ö‡∏ï</button>

<hr>

<button type="button" onclick="exportExcel()">Export Excel</button>
<button type="button" style="background:#dc3545;color:white;" onclick="clearHistory()">
‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥
</button>
<button type="button" style="background:#6f42c1;color:white;" onclick="resetAll()">
‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏∞‡∏ö‡∏ö
</button>
<button type="button" style="background:#343a40;color:white;" onclick="adminLogin()">
‡πÇ‡∏´‡∏°‡∏î‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô
</button>

<div id="adminStatus" style="text-align:center;font-size:12px;color:red;">
‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô
</div>

<input type="file" id="fileInput" hidden>

</form>

<div class="grid" id="grid"></div>

</div>

<div class="history">

<h3>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h3>

<table>
<thead>
<tr>
<th>‡∏£‡∏´‡∏±‡∏™‡πÅ‡∏ö‡∏ï</th>
<th>‡∏ä‡∏∑‡πà‡∏≠</th>
<th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ö‡∏¥‡∏Å</th>
<th>‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏ö‡∏¥‡∏Å</th>
<th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏∑‡∏ô</th>
<th>‡πÄ‡∏ß‡∏•‡∏≤‡∏Ñ‡∏∑‡∏ô</th>
</tr>
</thead>

<tbody id="history"></tbody>
</table>

</div>

<script>

// ================= ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô =================
const employees = {
"7912135":"‡∏Ñ‡∏∏‡∏ì ‡∏≠‡∏£‡∏û‡∏¥‡∏ô‡∏ó‡πå ‡∏ó‡∏≠‡∏á‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå‡∏î‡∏µ",
"7912136":"‡∏Ñ‡∏∏‡∏ì ‡∏ì‡∏£‡∏á‡∏Ñ‡πå‡∏§‡∏ó‡∏ò‡∏¥‡πå ‡∏ß‡∏£‡∏£‡∏ì‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå",
"7638242":"‡∏Ñ‡∏∏‡∏ì ‡∏ß‡∏£‡∏£‡∏ì‡∏¥‡∏©‡∏≤ ‡πÄ‡∏Å‡∏©‡∏°‡∏™‡∏∏‡∏Ç",
"7845784":"‡∏Ñ‡∏∏‡∏ì ‡∏≠‡∏±‡∏©‡∏é‡∏≤‡∏ß‡∏∏‡∏ò ‡∏°‡∏µ‡∏Ñ‡∏≤‡∏ô",
"7860504":"‡∏Ñ‡∏∏‡∏ì ‡∏†‡∏±‡∏ó‡∏£‡∏û‡∏• ‡πÅ‡∏™‡∏ß‡∏á‡∏û‡∏£",
"7663830":"‡∏Ñ‡∏∏‡∏ì ‡∏≠‡∏¥‡∏ó‡∏ò‡∏¥‡∏û‡∏• ‡∏£‡∏∞‡πÅ‡∏™‡∏ô‡∏û‡∏£‡∏´‡∏°",
"7584491":"‡∏Ñ‡∏∏‡∏ì ‡∏≠‡∏±‡∏ç‡∏ä‡∏•‡∏µ ‡∏´‡∏≠‡∏°‡∏´‡∏ß‡∏•",
"7902168":"‡∏Ñ‡∏∏‡∏ì ‡∏™‡∏∏‡∏Å‡∏±‡∏ç‡∏ç‡∏≤ ‡∏î‡∏≤‡∏ß‡∏•‡∏≠‡∏¢",
"7827144":"‡∏Ñ‡∏∏‡∏ì ‡πÄ‡∏à‡∏©‡∏é‡∏≤‡∏†‡∏£‡∏ì‡πå ‡∏ó‡∏≠‡∏á‡πÄ‡∏û‡πá‡∏ä‡∏£‡πå",
"7897419":"‡∏Ñ‡∏∏‡∏ì ‡πÄ‡∏â‡∏•‡∏¥‡∏°‡∏ä‡∏±‡∏¢ ‡∏®‡∏£‡∏µ‡∏ó‡∏±‡∏ô",
"7897425":"‡∏Ñ‡∏∏‡∏ì ‡∏õ‡∏±‡∏ê‡∏°‡∏≤ ‡πÇ‡∏™‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå",
"7897562":"‡∏Ñ‡∏∏‡∏ì ‡πÇ‡∏™‡∏£‡∏¢‡∏≤ ‡∏™‡∏∏‡∏û‡∏£‡∏£‡∏ì",
"7897564":"‡∏Ñ‡∏∏‡∏ì ‡∏≠‡∏£‡∏∏‡∏ì ‡πÇ‡∏£‡∏°‡∏£‡∏±‡∏°‡∏¢‡πå",
"7888343":"‡∏Ñ‡∏∏‡∏ì ‡∏û‡∏±‡∏™‡∏Å‡∏£ ‡πÅ‡∏Å‡πâ‡∏ß‡∏≠‡∏∏‡∏î‡∏£",
"7888345":"‡∏Ñ‡∏∏‡∏ì ‡∏£‡∏∏‡πâ‡∏á‡∏ô‡∏†‡∏≤ ‡πÄ‡∏û‡πá‡∏á‡∏™‡∏µ‡πÅ‡∏™‡∏á",
"7887303":"‡∏Ñ‡∏∏‡∏ì ‡∏£‡∏±‡∏ï‡∏ô‡πÄ‡∏î‡∏ä ‡πÄ‡∏ß‡∏£‡∏∏‡∏ö‡∏±‡∏ö",
"7887402":"‡∏Ñ‡∏∏‡∏ì ‡∏°‡∏±‡∏ì‡∏ë‡∏ô‡∏≤ ‡πÇ‡∏Å‡∏è‡∏¥‡∏£‡∏±‡∏Å‡∏©‡πå",
"7887458":"‡∏Ñ‡∏∏‡∏ì ‡∏ò‡∏ô‡∏û‡∏£ ‡πÅ‡∏ã‡πà‡∏ú‡πà‡∏≤‡∏ô",
"7887461":"‡∏Ñ‡∏∏‡∏ì ‡∏†‡∏≤‡∏ì‡∏∏‡∏û‡∏á‡∏®‡πå ‡πÑ‡∏Å‡∏£‡∏®‡∏£",
"7870341":"‡∏Ñ‡∏∏‡∏ì ‡∏≠‡∏î‡∏¥‡∏®‡∏≤ ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏±‡∏ï‡∏ô‡πå",
"7870344":"‡∏Ñ‡∏∏‡∏ì ‡∏ò‡∏ô‡∏≤‡∏û‡∏¥‡∏ß‡∏£‡∏£‡∏ò‡∏ô‡πå ‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏°‡∏µ",
"7796446":"‡∏Ñ‡∏∏‡∏ì ‡∏ò‡∏ô‡∏ß‡∏±‡∏í‡∏ô‡πå ‡∏ó‡∏∞‡∏ô‡∏á‡∏Ñ‡πå",
"7503735":"‡∏Ñ‡∏∏‡∏ì ‡∏°‡∏∏‡∏ó‡∏¥‡∏ï‡∏≤ ‡πÅ‡∏Å‡πâ‡∏ß‡∏Å‡∏≠‡∏á‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå",
"7641691":"‡∏Ñ‡∏∏‡∏ì ‡∏™‡∏∏‡∏Å‡∏±‡∏ç‡∏ç‡∏≤ ‡πÄ‡∏û‡πá‡∏ä‡∏£‡∏≠‡∏≤‡∏ß‡∏∏‡∏ò",
"7729233":"‡∏Ñ‡∏∏‡∏ì ‡∏®‡∏∏‡∏†‡∏ä‡∏±‡∏¢ ‡∏≠‡∏∏‡∏õ‡∏≤‡∏™‡πÇ‡∏†",
"6214535":"‡∏Ñ‡∏∏‡∏ì ‡∏¢‡∏∏‡∏ó‡∏ò‡∏ô‡∏≤ ‡πÄ‡∏ö‡πá‡∏ç‡∏°‡∏≤‡∏®",
"7669866":"‡∏Ñ‡∏∏‡∏ì ‡∏ô‡∏á‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå ‡∏û‡∏∂‡πà‡∏á‡∏ä‡∏∞‡∏≠‡∏∏‡πà‡∏°",
"7829336":"‡∏Ñ‡∏∏‡∏ì ‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥‡∏Å‡∏∏‡∏• ‡∏ß‡∏≤‡πÇ‡∏¢‡∏ö‡∏∏‡∏ï‡∏£",
"7833155":"‡∏Ñ‡∏∏‡∏ì ‡∏≠‡∏±‡∏©‡∏é‡∏≤ ‡πÇ‡∏≠‡πâ‡∏ô",
"7834546":"‡∏Ñ‡∏∏‡∏ì ‡∏ò‡∏ô‡∏≤‡∏¢‡∏∏‡∏ó‡∏ò ‡πÅ‡∏™‡∏ô‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡πå",
"7834655":"‡∏Ñ‡∏∏‡∏ì ‡∏õ‡∏è‡∏¥‡∏†‡∏≤‡∏ì ‡∏•‡∏≤‡∏´‡∏≤‡∏ç",
"7834663":"‡∏Ñ‡∏∏‡∏ì ‡∏≠‡∏†‡∏¥‡∏£‡∏±‡∏Å‡∏©‡πå ‡∏•‡∏≠‡∏¢‡πÄ‡∏•‡∏¥‡∏®",
"7825786":"‡∏Ñ‡∏∏‡∏ì ‡∏Å‡∏¥‡∏ï‡∏ï‡∏¥‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå ‡∏ô‡∏≤‡∏´‡∏±‡∏ß‡∏î‡∏á",
"7825789":"‡∏Ñ‡∏∏‡∏ì ‡∏Å‡∏£‡∏£‡∏ì‡∏¥‡∏Å‡∏≤‡∏ô‡∏ï‡πå ‡πÄ‡∏ß‡∏£‡∏∏‡∏ö‡∏±‡∏ö",
"7660173":"‡∏Ñ‡∏∏‡∏ì ‡∏™‡∏∏‡∏ß‡∏ô‡∏µ‡∏¢‡πå ‡∏™‡∏±‡∏á‡∏Ç‡πå‡∏™‡∏ß‡πà‡∏≤‡∏á",
"7679760":"‡∏Ñ‡∏∏‡∏ì ‡∏â‡∏±‡∏ï‡∏£‡∏°‡∏á‡∏Ñ‡∏• ‡∏õ‡∏±‡∏î‡∏ï‡∏±‡∏á‡πÄ‡∏ß",
"7617193":"‡∏Ñ‡∏∏‡∏ì ‡∏à‡∏¥‡∏î‡∏≤‡∏†‡∏≤ ‡∏Ñ‡∏≥‡∏™‡∏±‡∏ï‡∏¢‡πå",
"7699980":"‡∏Ñ‡∏∏‡∏ì ‡∏õ‡∏≤‡∏•‡∏¥‡∏ï‡∏≤ ‡πÄ‡∏û‡∏µ‡∏¢‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ",
"7784389":"‡∏Ñ‡∏∏‡∏ì ‡∏Å‡∏¥‡∏ï‡∏ï‡∏¥‡∏¢‡∏≤ ‡∏ö‡∏∏‡∏ç‡πÄ‡∏Å‡∏¥‡∏î",
"7811696":"‡∏Ñ‡∏∏‡∏ì ‡∏≠‡∏ô‡∏∏‡∏™‡∏£‡∏ì‡πå ‡∏à‡∏±‡∏ô‡∏§‡∏ä‡∏±‡∏¢",
"7655237":"‡∏Ñ‡∏∏‡∏ì ‡∏û‡∏¥‡∏ó‡∏¢‡∏≤‡∏†‡∏£‡∏ì‡πå ‡πÄ‡∏Å‡∏¥‡∏î‡∏£‡∏∑‡πà‡∏ô",
"7789326":"‡∏Ñ‡∏∏‡∏ì ‡πÄ‡∏™‡∏è‡∏ê‡∏ß‡∏∏‡∏í‡∏¥ ‡∏™‡∏±‡∏á‡∏Ü‡∏∞‡πÄ‡∏ß‡∏ä",
"7803067":"‡∏Ñ‡∏∏‡∏ì ‡∏ò‡∏µ‡∏£‡∏û‡∏á‡∏©‡πå ‡∏ß‡∏±‡∏á‡∏á‡∏≤‡∏°",
"7807878":"‡∏Ñ‡∏∏‡∏ì ‡∏ô‡∏±‡∏ô‡∏ó‡∏ß‡∏∏‡∏í‡∏¥ ‡∏ä‡∏≤‡∏ï‡∏¥‡∏™‡∏∏‡∏Ç",
"6895657":"‡∏Ñ‡∏∏‡∏ì ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ô‡∏≤‡∏£‡∏≤ ‡∏õ‡∏£‡∏∑‡∏≠‡∏õ‡∏£‡∏±‡∏Å",
"6917349":"‡∏Ñ‡∏∏‡∏ì ‡∏Å‡∏±‡∏™‡∏ì‡∏∞ ‡πÄ‡∏™‡∏î‡∏≤",
"6917358":"‡∏Ñ‡∏∏‡∏ì ‡∏™‡∏∏‡∏ß‡∏£‡∏£‡∏•‡∏µ ‡∏™‡∏∏‡∏£‡∏∞‡∏ó‡∏¥‡∏û‡∏¢‡πå",
"6969952":"‡∏Ñ‡∏∏‡∏ì ‡∏™‡∏∏‡∏£‡∏¥‡∏¢‡∏∞ ‡∏ô‡∏≤‡∏ä‡∏±‡∏¢‡∏•‡∏≠‡∏á",
"6697942":"‡∏Ñ‡∏∏‡∏ì ‡∏ô‡∏¥‡∏†‡∏≤‡∏†‡∏£‡∏ì‡πå ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡πà‡∏á",
"6864039":"‡∏Ñ‡∏∏‡∏ì ‡∏≠‡∏£‡∏£‡∏ñ‡∏û‡∏• ‡∏ô‡∏¥‡∏°‡∏≤",
"6778837":"‡∏Ñ‡∏∏‡∏ì ‡∏õ‡∏ô‡∏±‡∏î‡∏î‡∏≤ ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏Ç‡∏±‡∏ô‡∏ï‡∏£‡∏µ",
"6697933":"‡∏Ñ‡∏∏‡∏ì ‡πÄ‡∏™‡∏≤‡∏ß‡∏ì‡∏µ ‡∏™‡∏¥‡∏á‡∏´‡πå‡πÄ‡∏à‡∏£‡∏¥‡∏ç",
"6623442":"‡∏Ñ‡∏∏‡∏ì ‡∏£‡∏±‡∏ï‡∏ï‡∏¥‡∏¢‡∏≤‡∏Å‡∏£ ‡∏Å‡∏•‡∏¥‡πà‡∏ô‡∏Å‡∏∏‡∏´‡∏•‡∏≤‡∏ö",
"6575280":"‡∏Ñ‡∏∏‡∏ì ‡∏û‡∏¥‡∏ó‡∏¢‡∏≤ ‡∏ó‡∏≠‡∏á‡∏´‡∏•‡πà‡∏≠",
"6620917":"‡∏Ñ‡∏∏‡∏ì ‡∏™‡∏∏‡∏ó‡∏ò‡∏µ ‡∏û‡∏£‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏¥‡πå",
"6469895":"‡∏Ñ‡∏∏‡∏ì ‡∏£‡∏±‡∏ä‡∏î‡∏≤‡∏†‡∏£‡∏ì‡πå ‡∏°‡∏≤‡∏•‡∏µ‡∏£‡∏±‡∏ï‡∏ô‡πå",
"6495063":"‡∏Ñ‡∏∏‡∏ì ‡πÄ‡∏õ‡∏£‡∏°‡∏§‡∏î‡∏µ ‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏™‡∏≠‡∏ô",
"6512598":"‡∏Ñ‡∏∏‡∏ì ‡∏à‡∏±‡∏ô‡∏à‡∏¥‡∏£‡∏≤ ‡πÅ‡∏™‡∏ß‡∏á‡∏û‡∏£",
"6512632":"‡∏Ñ‡∏∏‡∏ì ‡πÄ‡∏™‡∏≤‡∏£‡πå‡πÅ‡∏Å‡πâ‡∏ß ‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏°‡∏≤",
"6408416":"‡∏Ñ‡∏∏‡∏ì ‡∏ß‡∏¥‡∏†‡∏≤‡∏ß‡∏µ ‡πÇ‡∏£‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏™‡∏£‡∏¥‡∏ê",
"6338233":"‡∏Ñ‡∏∏‡∏ì ‡πÄ‡∏û‡πá‡∏ç‡∏ô‡∏†‡∏≤ ‡∏à‡∏¥‡∏ï‡∏™‡∏∏‡∏ß‡∏£‡∏£‡∏ì",
"6436083":"‡∏Ñ‡∏∏‡∏ì ‡∏ß‡∏¥‡∏†‡∏≤‡∏ß‡∏î‡∏µ ‡∏Å‡∏π‡πâ‡∏ï‡∏£‡∏∞‡∏Å‡∏π‡∏•‡∏ß‡∏á‡∏®‡πå",
"6436118":"‡∏Ñ‡∏∏‡∏ì ‡∏™‡∏≥‡∏†‡∏≤‡∏©‡∏ì‡πå ‡∏™‡∏ß‡∏ô‡∏ö‡∏≤‡∏ô",
"6338242":"‡∏Ñ‡∏∏‡∏ì ‡∏õ‡∏£‡∏≤‡∏ì‡∏µ ‡∏£‡∏π‡∏ß‡∏±‡∏ô‡∏°‡∏≠‡∏°",
"6338251":"‡∏Ñ‡∏∏‡∏ì ‡∏à‡∏£‡∏π‡∏ç ‡∏Æ‡∏∏‡∏á‡∏™‡∏≤‡∏¢",
"6349249":"‡∏Ñ‡∏∏‡∏ì ‡∏ò‡∏ß‡∏±‡∏ä‡∏ä‡∏±‡∏¢ ‡πÄ‡∏ñ‡∏≤‡∏û‡∏¥‡∏°‡∏≤‡∏¢",
"6273944":"‡∏Ñ‡∏∏‡∏ì ‡∏ô‡∏¥‡∏û‡∏û‡∏• ‡∏ß‡∏á‡∏Ñ‡πå‡πÅ‡∏Å‡πâ‡∏ß",
"6150443":"‡∏Ñ‡∏∏‡∏ì ‡∏ê‡∏¥‡∏ï‡∏¥‡∏£‡∏±‡∏ï‡∏ô‡πå ‡πÄ‡∏ó‡∏®‡∏ó‡∏≠‡∏á",
"6221929":"‡∏Ñ‡∏∏‡∏ì ‡∏†‡∏≤‡∏Ñ‡∏†‡∏π‡∏°‡∏¥ ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏ô‡∏≤‡∏Ñ",
"6165561":"‡∏Ñ‡∏∏‡∏ì ‡∏ß‡∏¥‡∏†‡∏≤‡∏ß‡∏µ ‡∏û‡∏£‡∏´‡∏°‡πÅ‡∏™‡∏á",
"6100499":"‡∏Ñ‡∏∏‡∏ì ‡∏ò‡∏£‡∏≤‡∏ó‡∏¥‡∏õ ‡∏Å‡∏±‡πâ‡∏ß‡∏®‡∏£‡∏µ",
"6081116":"‡∏Ñ‡∏∏‡∏ì ‡∏ó‡∏¥‡∏û‡∏ß‡∏£‡∏£‡∏ì ‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏ô‡∏∏‡πà‡∏ô",
"6015652":"‡∏Ñ‡∏∏‡∏ì ‡∏ß‡∏£‡∏≤‡∏Å‡∏£ ‡∏õ‡∏•‡∏∑‡πâ‡∏°‡∏≠‡∏∏‡∏î‡∏°",
"5981413":"‡∏Ñ‡∏∏‡∏ì ‡∏™‡∏∏‡∏†‡∏±‡∏Ñ‡∏Ñ‡πå ‡∏ñ‡πà‡∏≠‡∏ô‡∏™‡∏±‡∏ô‡πÄ‡∏ó‡∏µ‡∏¢‡∏∞",
"5855700":"‡∏Ñ‡∏∏‡∏ì ‡∏Ñ‡∏á‡πÄ‡∏î‡∏ä ‡∏ä‡πà‡∏≤‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏ô‡∏Å‡∏∏‡∏•",
"5793643":"‡∏Ñ‡∏∏‡∏ì ‡∏ò‡∏ô‡∏Å‡∏§‡∏© ‡πÄ‡∏à‡∏£‡∏¥‡∏ç‡∏®‡∏£‡∏µ",
"5799166":"‡∏Ñ‡∏∏‡∏ì ‡∏ß‡∏ô‡∏¥‡∏î‡∏≤ ‡∏™‡∏∏‡∏Ç‡πÄ‡∏û‡∏ä‡∏£",
"5845115":"‡∏Ñ‡∏∏‡∏ì ‡∏≠‡∏ï‡∏¥‡∏Å‡∏≤‡∏ô‡∏ï‡πå ‡πÄ‡∏ó‡∏û‡∏ó‡∏≠‡∏á",
"5746678":"‡∏Ñ‡∏∏‡∏ì ‡∏™‡∏ô‡∏ò‡∏ç‡∏≤ ‡∏î‡∏ß‡∏á‡∏û‡∏£‡∏∞‡∏ó‡∏±‡∏¢",
"5798390":"‡∏Ñ‡∏∏‡∏ì ‡∏ä‡∏∏‡∏ï‡∏¥‡∏°‡∏≤ ‡∏Ñ‡∏á‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡πå",
"5799175":"‡∏Ñ‡∏∏‡∏ì ‡∏®‡∏¥‡∏£‡∏¥‡∏ä‡∏±‡∏¢ ‡∏ò‡∏á‡∏™‡∏µ",
"5302656":"‡∏Ñ‡∏∏‡∏ì ‡∏û‡∏á‡∏®‡∏Å‡∏£ ‡∏•‡∏±‡∏ö‡∏™‡∏∏‡∏£‡∏¥‡∏¢‡πå",
"5300907":"‡∏Ñ‡∏∏‡∏ì ‡∏Ñ‡∏£‡∏£‡∏ä‡∏¥‡∏ï ‡∏≠‡∏£‡∏£‡∏Ñ‡∏®‡∏£‡∏µ‡∏ß‡∏£",
"5129773":"‡∏Ñ‡∏∏‡∏ì ‡∏û‡∏£‡∏ô‡∏†‡∏≤ ‡∏ö‡∏∏‡∏ç‡∏ò‡∏£‡∏£‡∏°",
"5129345":"‡∏Ñ‡∏∏‡∏ì ‡∏â‡∏±‡∏ï‡∏£‡∏ä‡∏≤‡∏¢ ‡∏™‡∏∏‡∏£‡∏¥‡∏¢‡∏∞‡∏™‡∏≤‡∏£",
"5129354":"‡∏Ñ‡∏∏‡∏ì ‡∏™‡∏´‡∏†‡∏≤‡∏û ‡πÉ‡∏à‡∏≠‡∏∏‡πà‡∏ô",
"0192491":"‡∏Ñ‡∏∏‡∏ì ‡∏Å‡∏±‡∏ç‡∏ç‡∏≤‡∏†‡∏±‡∏ó‡∏£ ‡πÅ‡∏ã‡πà‡πÄ‡∏≠‡∏µ‡πâ‡∏¢‡∏ß",
"0752082":"‡∏Ñ‡∏∏‡∏ì ‡∏û‡∏¥‡πÄ‡∏ä‡∏ê ‡∏à‡πà‡∏≠‡∏ô‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß",
"0308973":"‡∏Ñ‡∏∏‡∏ì ‡∏ô‡∏û‡∏î‡∏• ‡∏û‡∏ß‡∏á‡∏•‡∏≥‡πÉ‡∏¢",
"0039684":"‡∏Ñ‡∏∏‡∏ì ‡∏°‡∏≤‡∏•‡∏µ ‡∏ú‡∏¥‡∏ß‡∏ö‡∏≤‡∏á",
"0039700":"‡∏Ñ‡∏∏‡∏ì ‡∏ì‡∏±‡∏ê‡∏û‡∏• ‡∏ß‡∏á‡∏©‡πå‡∏ô‡∏≤‡∏Ñ‡∏ô‡πâ‡∏≠‡∏¢",
"0617176":"‡∏Ñ‡∏∏‡∏ì ‡∏ì‡∏±‡∏ê‡∏ò‡∏¥‡∏ä‡∏≤ ‡∏ô‡∏±‡∏ô‡∏ï‡∏∞‡∏ß‡∏á‡∏Ñ‡πå",
"0617559":"‡∏Ñ‡∏∏‡∏ì ‡∏™‡∏∏‡∏û‡∏£‡∏£‡∏ì‡∏´‡∏á‡∏©‡πå ‡πÉ‡∏Ñ‡∏£‡πà‡∏Ñ‡∏£‡∏ß‡∏ç",
"0617586":"‡∏Ñ‡∏∏‡∏ì ‡∏™‡∏∏‡∏£‡πÄ‡∏ä‡∏©‡∏ê‡πå ‡πÉ‡∏Ñ‡∏£‡πà‡∏Ñ‡∏£‡∏ß‡∏ç",
"0616630":"‡∏Ñ‡∏∏‡∏ì ‡∏≠‡∏£‡∏¥‡∏™‡∏£‡∏≤ ‡∏ß‡∏£‡∏£‡∏ì‡πå‡∏ó‡∏≠‡∏á",
"0617185":"‡∏Ñ‡∏∏‡∏ì ‡∏ô‡∏û ‡πÅ‡∏û‡∏á‡∏Å‡∏¥‡πà‡∏á",
"7106080":"‡∏Ñ‡∏∏‡∏ì ‡∏≠‡∏≤‡∏£‡∏µ‡∏¢‡∏≤ ‡∏ó‡∏≠‡∏á‡∏Å‡∏£‡∏∞‡∏ó‡∏∏‡πà‡∏°",
"7034988":"‡∏Ñ‡∏∏‡∏ì ‡∏ò‡∏£‡∏ì‡∏¥‡∏ô‡∏ó‡∏£‡πå ‡∏õ‡∏£‡∏≤‡∏®‡∏±‡∏¢‡∏á‡∏≤‡∏°",
"7105009":"‡∏Ñ‡∏∏‡∏ì ‡∏ß‡∏¥‡∏ä‡∏≤‡∏ç ‡πÉ‡∏ö‡πÅ‡∏™‡∏ô",
"7105018":"‡∏Ñ‡∏∏‡∏ì ‡πÅ‡∏à‡πà‡∏°‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå ‡∏°‡∏∞‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡πå"
};


// ================= ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ =================
let batteries = {};
let history = [];


// ================= Save / Load =================
function saveData(){
    localStorage.setItem("batteries",JSON.stringify(batteries));
    localStorage.setItem("history",JSON.stringify(history));
}

function loadData(){

    let b = localStorage.getItem("batteries");
    let h = localStorage.getItem("history");

    if(b) batteries = JSON.parse(b);
    if(h) history = JSON.parse(h);
}

loadData();

if(Object.keys(batteries).length===0){

    for(let i=1;i<=40;i++){

        let code = "RE."+String(i).padStart(2,"0");

        batteries[code]={ status:"free" };
    }
}


// ================= ‡πÄ‡∏ß‡∏•‡∏≤ =================
function getDateTime(){

    let now = new Date();

    return{
        date: now.toLocaleDateString("th-TH"),
        time: now.toLocaleTimeString("th-TH")
    };
}


// ================= Dropdown RF =================
const rfSelect = document.getElementById("rf");

function loadRF(){

    rfSelect.innerHTML=`<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ö‡∏ï --</option>`;

    for(let i=1;i<=40;i++){

        let code="RE."+String(i).padStart(2,"0");

        let opt=document.createElement("option");

        opt.value=code;
        opt.textContent=code;

        rfSelect.appendChild(opt);
    }
}

loadRF();


// ================= ‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏ö‡∏ï =================
const grid=document.getElementById("grid");

function render(){

    grid.innerHTML="";

    for(let key in batteries){

        let b=batteries[key];

        let div=document.createElement("div");

        div.className="cell "+(b.status==="free"?"free":"used");

        div.innerHTML=`
            ${key}<br>
            <div class="info">
            ${b.status==="free"?"‡∏ß‡πà‡∏≤‡∏á":b.name}
            </div>
        `;

        grid.appendChild(div);
    }
}

render();


// ================= ‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô =================
const empID=document.getElementById("empID");
const empName=document.getElementById("empName");

empID.addEventListener("input",()=>{

    empName.value=employees[empID.value]||"";

});


// ================= ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥ =================
function renderHistory(){

    let h=document.getElementById("history");

    h.innerHTML="";

    history.forEach(r=>{

        let row=h.insertRow();

        row.insertCell(0).innerHTML=r.rf;
        row.insertCell(1).innerHTML=r.name;
        row.insertCell(2).innerHTML=r.borrowDate;
        row.insertCell(3).innerHTML=r.borrowTime;
        row.insertCell(4).innerHTML=r.returnDate||"-";
        row.insertCell(5).innerHTML=r.returnTime||"-";
    });
}

renderHistory();


// ================= ‡πÄ‡∏ö‡∏¥‡∏Å =================
document.getElementById("form").addEventListener("submit",function(e){

e.preventDefault();

let name=empName.value;
let rf=rfSelect.value;

if(!name){
    alert("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô");
    return;
}

if(!rf){
    alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ö‡∏ï");
    return;
}

if(batteries[rf].status==="used"){
    alert("‡∏ñ‡∏π‡∏Å‡∏¢‡∏∑‡∏°‡πÅ‡∏•‡πâ‡∏ß");
    return;
}

let t=getDateTime();

batteries[rf]={
    status:"used",
    name:name,
    borrowDate:t.date,
    borrowTime:t.time
};

history.push({
    rf,
    name,
    borrowDate:t.date,
    borrowTime:t.time,
    returnDate:"",
    returnTime:""
});

render();
renderHistory();
saveData();

this.reset();
loadRF();

});


// ================= ‡∏Ñ‡∏∑‡∏ô =================
function returnBattery(){

    let rf = rfSelect.value;
    let empId = empID.value;
    let name = empName.value;

    if(!rf){
        alert("‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ö‡∏ï‡∏Å‡πà‡∏≠‡∏ô");
        return;
    }

    if(!empId || !name){
        alert("‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏∑‡∏ô");
        return;
    }

    if(batteries[rf].status==="free"){
        alert("‡πÅ‡∏ö‡∏ï‡∏ô‡∏µ‡πâ‡∏¢‡∏±‡∏á‡∏ß‡πà‡∏≤‡∏á ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡∏¢‡∏∑‡∏°");
        return;
    }

    // üî¥ ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏∑‡∏°‡∏à‡∏£‡∏¥‡∏á‡πÑ‡∏´‡∏°
    if(batteries[rf].name !== name){
        alert("‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏¢‡∏∑‡∏°‡πÅ‡∏ö‡∏ï‡∏ô‡∏µ‡πâ");
        return;
    }

    let t = getDateTime();

    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥
    for(let i=history.length-1;i>=0;i--){

        if(history[i].rf===rf && history[i].returnDate===""){

            history[i].returnDate = t.date;
            history[i].returnTime = t.time;
            break;
        }
    }

    // ‡∏Ñ‡∏∑‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
    batteries[rf] = { status:"free" };

    render();
    renderHistory();
    saveData();

    alert("‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢");

    document.getElementById("form").reset();
    loadRF();
}


// ================= Backup =================
function exportData(){

let data={ batteries,history };

let json=JSON.stringify(data,null,2);

let blob=new Blob([json],{type:"application/json"});

let url=URL.createObjectURL(blob);

let a=document.createElement("a");

a.href=url;
a.download="battery_backup.json";
a.click();

URL.revokeObjectURL(url);

}

// ================= Export Excel ‡πÅ‡∏ó‡πâ =================
function exportExcel(){

    if(history.length===0){
        alert("‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•");
        return;
    }

    let data = [];

    // ‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á
    data.push([
        "‡∏£‡∏´‡∏±‡∏™‡πÅ‡∏ö‡∏ï",
        "‡∏ä‡∏∑‡πà‡∏≠",
        "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ö‡∏¥‡∏Å",
        "‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏ö‡∏¥‡∏Å",
        "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏∑‡∏ô",
        "‡πÄ‡∏ß‡∏•‡∏≤‡∏Ñ‡∏∑‡∏ô"
    ]);

    // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    history.forEach(r=>{

        data.push([
            r.rf,
            r.name,
            r.borrowDate,
            r.borrowTime,
            r.returnDate || "",
            r.returnTime || ""
        ]);

    });

    // ‡∏™‡∏£‡πâ‡∏≤‡∏á Sheet
    let ws = XLSX.utils.aoa_to_sheet(data);

    // ‡∏™‡∏£‡πâ‡∏≤‡∏á Workbook
    let wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "History");

    // Export
    XLSX.writeFile(wb, "battery_history.xlsx");

}

// ================= ‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥ =================
function clearHistory(){

    if(!isAdmin){
        alert("‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô");
        return;
    }

    if(!confirm("‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?")){
        return;
    }

    history = [];

    localStorage.removeItem("history");

    renderHistory();
    saveData();

    alert("‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß");
}

// ================= ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î =================
function resetAll(){

    if(!isAdmin){
        alert("‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô");
        return;
    }

    if(!confirm("‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?")){
        return;
    }

    batteries = {};

    for(let i=1;i<=40;i++){

        let code = "RE."+String(i).padStart(2,"0");

        batteries[code] = { status:"free" };
    }

    history = [];

    localStorage.clear();

    saveData();

    render();
    renderHistory();
    loadRF();

    document.getElementById("form").reset();

    alert("‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß");
}

// ================= ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô =================

let isAdmin = false;

// ‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ (‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏î‡πâ)
const ADMIN_PASSWORD = "nestkungeiei";

function adminLogin(){

    if(isAdmin){
        alert("‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÇ‡∏´‡∏°‡∏î‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß");
        return;
    }

    let pass = prompt("‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô:");

    if(pass === ADMIN_PASSWORD){

        isAdmin = true;

        document.getElementById("adminStatus").innerText =
        "‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡πÇ‡∏´‡∏°‡∏î‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß";

        document.getElementById("adminStatus").style.color = "green";

        alert("‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡πÇ‡∏´‡∏°‡∏î‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");

    }else{

        alert("‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ú‡∏¥‡∏î");
    }
}
</script>

</body>
</html>
